<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏ã‡∏ï‡πå‡πÄ‡∏™‡∏∑‡πâ‡∏≠ - ‡∏ä‡∏á‡πÇ‡∏Ñ‡πÄ‡∏Å‡∏°‡∏™‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            /* Maroon Pastel Gradient (Rose tones) */
            background: linear-gradient(135deg, #fff1f2 0%, #fda4af 100%); 
        }
        h1, h2, h3, .font-heading { font-family: 'Kanit', sans-serif; }
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 1);
            box-shadow: 0 10px 40px rgba(159, 18, 57, 0.15); /* Shadow with maroon tint */
        }
        .btn-pastel-maroon {
            /* Gradient from soft rose to deeper maroon-ish rose */
            background: linear-gradient(90deg, #fb7185, #e11d48);
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(225, 29, 72, 0.3);
        }
        .btn-pastel-maroon:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(225, 29, 72, 0.4);
        }
        .input-pastel {
            @apply bg-rose-50 border-rose-100 text-slate-700 focus:ring-2 focus:ring-rose-200 outline-none;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 relative">
    
    <!-- Decorative Blobs (Maroon/Rose tones) -->
    <div class="absolute top-10 left-10 w-32 h-32 bg-rose-200 rounded-full mix-blend-multiply filter blur-2xl opacity-70 animate-blob"></div>
    <div class="absolute bottom-10 right-10 w-32 h-32 bg-rose-300 rounded-full mix-blend-multiply filter blur-2xl opacity-70 animate-blob animation-delay-2000"></div>

    <div id="app" class="glass-card p-8 md:p-10 rounded-[2.5rem] shadow-2xl w-full max-w-lg relative z-10">

        <div class="text-center mb-8 mt-6">
            <!-- College Logo Added -->
            <img src="png.png" alt="Logo" class="h-24 w-auto mx-auto mb-4 drop-shadow-md hover:scale-105 transition duration-500">
            <h1 class="text-3xl font-bold font-heading text-rose-800 mb-2">‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏ã‡∏ï‡πå‡πÄ‡∏™‡∏∑‡πâ‡∏≠</h1>
            <p class="text-slate-500 text-sm">‡∏á‡∏≤‡∏ô‡∏Å‡∏µ‡∏¨‡∏≤‡∏ä‡∏á‡πÇ‡∏Ñ‡πÄ‡∏Å‡∏°‡∏™‡πå ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏±‡∏á‡∏á‡∏≤</p>
            <div class="h-1 w-20 bg-rose-300 mx-auto mt-4 rounded-full"></div>
        </div>

        <form @submit.prevent="confirmSubmit" class="space-y-5">
            <div>
                <label class="text-sm font-bold text-rose-700 ml-2 mb-1 block">‡∏™‡∏µ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label>
                <select v-model="form.color" class="w-full p-4 rounded-2xl text-sm input-pastel border cursor-pointer" required>
                    <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</option>
                    <option value="purple">üíú ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á</option>
                    <option value="skyblue">üíô ‡∏™‡∏µ‡∏ü‡πâ‡∏≤</option>
                    <option value="blue">üîµ ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</option>
                    <option value="green">üíö ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</option>
                    <option value="orange">üß° ‡∏™‡∏µ‡πÅ‡∏™‡∏î</option>
                    <option value="yellow">üíõ ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</option>
                </select>
            </div>
            
            <div v-if="form.color" class="animate-fade-in">
                <label class="text-sm font-bold text-rose-700 ml-2 mb-1 block">‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤</label>
                <select v-model="form.department" class="w-full p-4 rounded-2xl text-sm input-pastel border cursor-pointer" required>
                    <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤</option>
                    <option v-for="dept in currentDepartmentOptions" :value="dept">{{ dept }}</option>
                </select>
            </div>

            <div class="grid grid-cols-1 gap-4">
                <div>
                    <label class="text-sm font-bold text-rose-700 ml-2 mb-1 block">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                    <input v-model="form.name" type="text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" class="w-full p-4 rounded-2xl text-sm input-pastel border" required>
                </div>
                <div>
                    <label class="text-sm font-bold text-rose-700 ml-2 mb-1 block">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                    <input v-model="form.student_id" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 662010..." class="w-full p-4 rounded-2xl text-sm input-pastel border" required>
                </div>
            </div>
            
            <div class="grid grid-cols-3 gap-3">
                <div class="col-span-1">
                    <label class="text-xs font-bold text-rose-700 ml-1 mb-1 block">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label>
                    <select v-model="form.level" class="w-full p-3 rounded-2xl text-sm input-pastel border text-center">
                        <option v-for="l in levels" :value="l.id">{{ l.name }}</option>
                    </select>
                </div>
                <div class="col-span-1">
                    <label class="text-xs font-bold text-rose-700 ml-1 mb-1 block">‡∏´‡πâ‡∏≠‡∏á</label>
                    <select v-model="form.room" class="w-full p-3 rounded-2xl text-sm input-pastel border text-center">
                        <option value="" disabled>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                        <option v-for="n in 10" :key="n" :value="n">{{ n }}</option>
                    </select>
                </div>
                <div class="col-span-1">
                    <label class="text-xs font-bold text-rose-700 ml-1 mb-1 block">‡πÑ‡∏ã‡∏ï‡πå‡πÄ‡∏™‡∏∑‡πâ‡∏≠</label>
                    <select v-model="form.shirt_size" class="w-full p-3 rounded-2xl text-sm input-pastel border text-center font-bold text-rose-600">
                        <option value="S">S</option>
                        <option value="M">M</option>
                        <option value="L">L</option>
                        <option value="XL">XL</option>
                        <option value="2XL">2XL</option>
                        <option value="3XL">3XL</option>
                        <option value="4XL">4XL</option>
                    </select>
                </div>
            </div>

            <button type="submit" class="w-full btn-pastel-maroon font-heading font-bold py-4 rounded-2xl shadow-lg text-lg mt-6 hover:scale-[1.02] active:scale-[0.98] transition">
                üöÄ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            </button>
        </form>
        
        <p class="text-center text-xs text-rose-300 mt-6 font-light">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏™‡πà‡∏á</p>
    </div>

    <script>
    const { createApp, ref, computed } = Vue;
    // üü¢ URL ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxiaKmMU7C5iWSBapSL-lalTVLPAhHGgyNFoFJ6Sr5RrLa7R5FM8GKNbnl-zUJg92WY/exec'; 

    createApp({
        setup() {
            const form = ref({ name: '', student_id: '', level: 'voc1', room: '', shirt_size: 'M', department: '', color: '' });
            
            // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ levels (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ dropdown ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)
            const levels = [
                { id: 'voc1', name: '‡∏õ‡∏ß‡∏ä. 1' },
                { id: 'voc2', name: '‡∏õ‡∏ß‡∏ä. 2' },
                { id: 'voc3', name: '‡∏õ‡∏ß‡∏ä. 3' },
                { id: 'dip1', name: '‡∏õ‡∏ß‡∏™. 1' },
                { id: 'dip2', name: '‡∏õ‡∏ß‡∏™. 2' }
            ];

            // 2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤ (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏∞‡∏ö‡∏∏‡∏°‡∏≤)
            const departments = {
                orange: ['‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤', '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£'], 
                green: ['‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå', '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®'], 
                purple: ['‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ê‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå'],
                skyblue: ['‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•', '‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°'], 
                blue: ['‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', '‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î'], 
                yellow: ['‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏•']
            };

            // 3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å ‡∏ï‡∏≤‡∏°‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const currentDepartmentOptions = computed(() => {
                if (!form.value.color) return [];
                // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏ß‡πà‡∏≤‡∏á‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠
                return departments[form.value.color] || [];
            });

            const confirmSubmit = () => {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                if (!form.value.color || !form.value.department || !form.value.name || !form.value.student_id) {
                    Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'warning');
                    return;
                }

                Swal.fire({
                    title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?',
                    html: `‡∏ä‡∏∑‡πà‡∏≠: ${form.value.name}<br>‡∏™‡∏µ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î: ${form.value.color}<br>‡πÅ‡∏ú‡∏ô‡∏Å: ${form.value.department}<br>‡πÑ‡∏ã‡∏ï‡πå: <b>${form.value.shirt_size}</b>`,
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#e11d48',
                    cancelButtonColor: '#d33',
                    confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                    cancelButtonText: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
                }).then((result) => {
                    if (result.isConfirmed) {
                        submitData();
                    }
                });
            };

            const submitData = async () => {
                try {
                    Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
                    
                    await axios.post(GOOGLE_SCRIPT_URL, JSON.stringify({ 
                        action: 'submitSurvey', 
                        ...form.value 
                    }), {
                        headers: { "Content-Type": "text/plain" }
                    });
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        text: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
                    }).then(() => {
                        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
                        form.value = { name: '', student_id: '', level: 'voc1', room: '', shirt_size: 'M', department: '', color: '' };
                    });
                } catch (e) {
                    console.error(e);
                    Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', 'error');
                }
            };

            // 4. ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡∏ï‡πâ‡∏≠‡∏á return ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ levels ‡πÅ‡∏•‡∏∞ currentDepartmentOptions ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤ HTML ‡πÉ‡∏ä‡πâ
            return { 
                form, 
                confirmSubmit,
                levels,
                currentDepartmentOptions
            };
        }
    }).mount('#app');
    </script>
</body>
</html>